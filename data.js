// Constante pour faciliter la lecture
// const TRANSPARENT = -1;
const T = -1; // Alias court

// Définition des tuiles (patterns 16x16) - PAS DE TRANSPARENCE
const TILES = {
    0: [ // Sol vide avec texture
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ],
    1: [ // Mur en briques détaillé
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
        [3,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3],
        [3,2,1,1,1,1,2,3,2,1,1,1,1,1,2,3],
        [3,2,1,1,1,1,2,3,2,1,1,1,1,1,2,3],
        [3,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3],
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
        [3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,3],
        [3,2,1,1,1,1,1,2,3,2,1,1,1,1,2,3],
        [3,2,1,1,1,1,1,2,3,2,1,1,1,1,2,3],
        [3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,3],
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
        [3,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3],
        [3,2,1,1,1,1,2,3,2,1,1,1,1,1,2,3],
        [3,2,1,1,1,1,2,3,2,1,1,1,1,1,2,3],
        [3,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3],
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]
    ],
    2: [ // Herbe haute détaillée
        [0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,1,2,1,0,0,0,0,1,2,1,0,0,0,0],
        [0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,0],
        [0,1,2,3,2,1,0,0,1,2,3,2,1,0,0,0],
        [0,0,1,2,1,0,0,0,0,1,2,1,0,0,0,0],
        [0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,0],
        [0,0,0,0,0,1,0,0,0,0,0,1,2,2,2,1],
        [0,0,0,0,1,2,1,0,0,0,0,1,2,3,2,1],
        [0,0,0,1,2,2,2,1,0,0,0,0,1,2,1,0],
        [0,0,0,1,2,3,2,1,0,0,0,0,0,1,0,0],
        [0,0,0,0,1,2,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ],
    3: [ // Rocher avec ombrage
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0],
        [0,0,0,2,3,3,3,3,3,3,3,2,0,0,0,0],
        [0,0,2,3,3,2,2,2,2,2,3,3,2,0,0,0],
        [0,2,3,3,2,2,1,1,1,2,2,3,3,2,0,0],
        [0,2,3,2,2,1,1,1,1,1,2,2,3,2,0,0],
        [0,2,3,2,1,1,1,0,1,1,1,2,3,2,0,0],
        [0,2,3,2,1,1,0,0,0,1,1,2,3,2,0,0],
        [0,2,3,2,1,1,1,0,1,1,1,2,3,2,0,0],
        [0,2,3,2,2,1,1,1,1,1,2,2,3,2,0,0],
        [0,2,3,3,2,2,1,1,1,2,2,3,3,2,0,0],
        [0,0,2,3,3,2,2,2,2,2,3,3,2,0,0,0],
        [0,0,0,2,3,3,3,3,3,3,3,2,0,0,0,0],
        [0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ],
    4: [ // Porte (téléporteur)
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
        [3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3],
        [3,2,0,0,0,0,0,0,0,0,0,0,0,0,2,3],
        [3,2,0,3,3,3,3,3,3,3,3,3,3,0,2,3],
        [3,2,0,3,2,2,2,2,2,2,2,2,3,0,2,3],
        [3,2,0,3,2,1,1,1,1,1,1,2,3,0,2,3],
        [3,2,0,3,2,1,0,0,0,0,1,2,3,0,2,3],
        [3,2,0,3,2,1,0,0,0,0,1,2,3,0,2,3],
        [3,2,0,3,2,1,0,0,0,0,1,2,3,0,2,3],
        [3,2,0,3,2,1,0,0,0,0,1,2,3,0,2,3],
        [3,2,0,3,2,1,1,1,1,1,1,2,3,0,2,3],
        [3,2,0,3,2,2,2,3,2,2,2,2,3,0,2,3],
        [3,2,0,3,3,3,3,2,3,3,3,3,3,0,2,3],
        [3,2,0,0,0,0,0,0,0,0,0,0,0,0,2,3],
        [3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3],
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]
    ],
    5: [ // Coffre fermé
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
        [0,0,3,2,2,2,2,2,2,2,2,2,2,3,0,0],
        [0,3,2,2,1,1,1,1,1,1,1,1,2,2,3,0],
        [3,2,2,1,1,1,1,1,1,1,1,1,1,2,2,3],
        [3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3],
        [3,2,3,2,2,2,2,2,2,2,2,2,2,3,2,3],
        [3,2,3,2,2,2,3,3,3,3,2,2,2,3,2,3],
        [3,2,3,2,2,2,3,2,2,3,2,2,2,3,2,3],
        [3,2,3,2,2,2,3,3,3,3,2,2,2,3,2,3],
        [3,2,3,2,2,2,2,2,2,2,2,2,2,3,2,3],
        [3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3],
        [0,3,2,2,2,2,2,2,2,2,2,2,2,2,3,0],
        [0,0,3,3,3,3,3,3,3,3,3,3,3,3,0,0]
    ],
    6: [ // Coffre ouvert
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0],
        [0,0,0,3,2,2,2,2,2,2,2,2,3,0,0,0],
        [0,0,3,2,2,1,1,1,1,1,1,2,2,3,0,0],
        [0,3,2,2,1,1,1,1,1,1,1,1,2,2,3,0],
        [0,3,2,1,1,1,1,1,1,1,1,1,1,2,3,0],
        [3,2,2,3,3,3,3,3,3,3,3,3,3,2,2,3],
        [3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3],
        [3,2,3,2,2,2,2,2,2,2,2,2,2,3,2,3],
        [3,2,3,2,2,2,3,3,3,3,2,2,2,3,2,3],
        [3,2,3,2,2,2,3,2,2,3,2,2,2,3,2,3],
        [3,2,3,2,2,2,3,3,3,3,2,2,2,3,2,3],
        [3,2,3,2,2,2,2,2,2,2,2,2,2,3,2,3],
        [3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3],
        [0,3,2,2,2,2,2,2,2,2,2,2,2,2,3,0],
        [0,0,3,3,3,3,3,3,3,3,3,3,3,3,0,0]
    ],
    7: [ // Bloc poussable
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0],
        [0,3,2,2,2,2,2,2,2,2,2,2,2,2,3,0],
        [0,3,2,3,3,3,3,3,3,3,3,3,3,2,3,0],
        [0,3,2,3,2,2,2,2,2,2,2,2,3,2,3,0],
        [0,3,2,3,2,1,1,1,1,1,1,2,3,2,3,0],
        [0,3,2,3,2,1,2,2,2,2,1,2,3,2,3,0],
        [0,3,2,3,2,1,2,3,3,2,1,2,3,2,3,0],
        [0,3,2,3,2,1,2,3,3,2,1,2,3,2,3,0],
        [0,3,2,3,2,1,2,2,2,2,1,2,3,2,3,0],
        [0,3,2,3,2,1,1,1,1,1,1,2,3,2,3,0],
        [0,3,2,3,2,2,2,2,2,2,2,2,3,2,3,0],
        [0,3,2,3,3,3,3,3,3,3,3,3,3,2,3,0],
        [0,3,2,2,2,2,2,2,2,2,2,2,2,2,3,0],
        [0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ],
    8: [ // Interrupteur désactivé
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
        [0,0,0,0,3,2,2,2,2,2,2,3,0,0,0,0],
        [0,0,0,0,3,2,3,3,3,3,2,3,0,0,0,0],
        [0,0,0,0,3,2,3,2,2,3,2,3,0,0,0,0],
        [0,0,0,0,3,2,3,2,2,3,2,3,0,0,0,0],
        [0,0,0,0,3,2,3,2,2,3,2,3,0,0,0,0],
        [0,0,0,0,3,2,3,3,3,3,2,3,0,0,0,0],
        [0,0,0,0,3,2,2,2,2,2,2,3,0,0,0,0],
        [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ],
    9: [ // Interrupteur activé
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
        [0,0,0,0,3,2,2,2,2,2,2,3,0,0,0,0],
        [0,0,0,0,3,2,1,1,1,1,2,3,0,0,0,0],
        [0,0,0,0,3,2,1,0,0,1,2,3,0,0,0,0],
        [0,0,0,0,3,2,1,0,0,1,2,3,0,0,0,0],
        [0,0,0,0,3,2,1,0,0,1,2,3,0,0,0,0],
        [0,0,0,0,3,2,1,1,1,1,2,3,0,0,0,0],
        [0,0,0,0,3,2,2,2,2,2,2,3,0,0,0,0],
        [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ],
    10: [ // Plaque de pression
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
        [0,0,3,2,2,2,2,2,2,2,2,2,2,3,0,0],
        [0,0,3,2,2,2,2,2,2,2,2,2,2,3,0,0],
        [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ]
};

// Sprite simple du joueur pour compatibilité arrière
const PLAYER_SPRITE = [
    [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
    [0,0,0,0,3,2,2,2,2,2,2,3,0,0,0,0],
    [0,0,0,3,2,2,1,1,1,1,2,2,3,0,0,0],
    [0,0,0,3,2,1,3,1,1,3,1,2,3,0,0,0],
    [0,0,0,3,2,1,1,1,1,1,1,2,3,0,0,0],
    [0,0,0,3,2,2,1,3,3,1,2,2,3,0,0,0],
    [0,0,0,0,3,2,2,2,2,2,2,3,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
    [0,0,0,0,3,3,2,2,2,2,3,3,0,0,0,0],
    [0,0,0,3,2,3,2,2,2,2,3,2,3,0,0,0],
    [0,0,3,2,2,3,3,3,3,3,3,2,2,3,0,0],
    [0,0,3,2,2,3,2,2,2,2,3,2,2,3,0,0],
    [0,0,0,3,3,3,2,2,2,2,3,3,3,0,0,0],
    [0,0,0,0,0,3,2,2,2,2,3,0,0,0,0,0],
    [0,0,0,0,3,3,3,0,0,3,3,3,0,0,0,0],
    [0,0,0,0,3,3,3,0,0,3,3,3,0,0,0,0]
];

// Sprites du joueur avec orientations (AVEC TRANSPARENCE)
const PLAYER_SPRITES = {
    down: [ // Orientation vers le bas (face)
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,3,2,2,1,1,1,1,2,2,3,T,T,T],
        [T,T,T,3,2,1,3,1,1,3,1,2,3,T,T,T],
        [T,T,T,3,2,1,1,1,1,1,1,2,3,T,T,T],
        [T,T,T,3,2,2,1,3,3,1,2,2,3,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
        [T,T,T,3,2,3,2,2,2,2,3,2,3,T,T,T],
        [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
        [T,T,3,2,2,3,2,2,2,2,3,2,2,3,T,T],
        [T,T,T,3,3,3,2,2,2,2,3,3,3,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T]
    ],
    up: [ // Orientation vers le haut (dos)
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
        [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
        [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
        [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
        [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
        [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
        [T,T,T,3,2,3,2,2,2,2,3,2,3,T,T,T],
        [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
        [T,T,3,2,2,3,2,2,2,2,3,2,2,3,T,T],
        [T,T,T,3,3,3,2,2,2,2,3,3,3,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T]
    ],
    left: [ // Orientation vers la gauche
        [T,T,T,T,T,T,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,T,3,2,2,1,1,1,2,2,3,T,T,T],
        [T,T,T,T,3,2,3,1,1,1,1,2,3,T,T,T],
        [T,T,T,T,3,2,1,1,1,1,1,2,3,T,T,T],
        [T,T,T,T,3,2,2,3,3,1,2,2,3,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,T,T,T,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,3,3,T,T,T,T],
        [T,T,T,3,2,2,3,3,3,3,3,2,3,T,T,T],
        [T,T,3,2,2,2,2,2,2,2,3,2,3,T,T,T],
        [T,T,T,3,3,3,2,2,2,2,3,3,T,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T]
    ],
    right: [ // Orientation vers la droite
        [T,T,T,T,T,3,3,3,3,3,T,T,T,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,3,2,2,1,1,1,2,2,3,T,T,T,T],
        [T,T,T,3,2,1,1,1,1,3,2,3,T,T,T,T],
        [T,T,T,3,2,1,1,1,1,1,2,3,T,T,T,T],
        [T,T,T,3,2,2,1,3,3,2,2,3,T,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,T,T,3,3,3,3,3,T,T,T,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,T,3,3,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,3,2,3,3,3,3,3,2,2,3,T,T,T],
        [T,T,T,3,2,3,2,2,2,2,2,2,3,T,T,T],
        [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T]
    ]
};

// Animation de marche pour chaque direction
const PLAYER_WALK_SPRITES = {
    down: [
        // Frame 1 - jambe gauche en avant
        [
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,3,2,2,1,1,1,1,2,2,3,T,T,T],
            [T,T,T,3,2,1,3,1,1,3,1,2,3,T,T,T],
            [T,T,T,3,2,1,1,1,1,1,1,2,3,T,T,T],
            [T,T,T,3,2,2,1,3,3,1,2,2,3,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,3,2,3,2,2,2,2,3,2,3,T,T,T],
            [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
            [T,T,3,2,2,3,2,2,2,2,3,2,2,3,T,T],
            [T,T,T,3,3,3,2,2,2,2,3,3,3,T,T,T],
            [T,T,T,T,3,3,2,T,T,2,2,3,T,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T]
        ],
        // Frame 2 - jambe droite en avant
        [
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,3,2,2,1,1,1,1,2,2,3,T,T,T],
            [T,T,T,3,2,1,3,1,1,3,1,2,3,T,T,T],
            [T,T,T,3,2,1,1,1,1,1,1,2,3,T,T,T],
            [T,T,T,3,2,2,1,3,3,1,2,2,3,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,3,2,3,2,2,2,2,3,2,3,T,T,T],
            [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
            [T,T,3,2,2,3,2,2,2,2,3,2,2,3,T,T],
            [T,T,T,3,3,3,2,2,2,2,3,3,3,T,T,T],
            [T,T,T,T,3,2,2,T,T,2,3,3,T,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T]
        ]
    ],
    up: [
        // Frame 1
        [
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,3,2,3,2,2,2,2,3,2,3,T,T,T],
            [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
            [T,T,3,2,2,3,2,2,2,2,3,2,2,3,T,T],
            [T,T,T,3,3,3,2,2,2,2,3,3,3,T,T,T],
            [T,T,T,T,3,3,2,T,T,2,2,3,T,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T]
        ],
        // Frame 2
        [
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
            [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
            [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,3,2,3,2,2,2,2,3,2,3,T,T,T],
            [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
            [T,T,3,2,2,3,2,2,2,2,3,2,2,3,T,T],
            [T,T,T,3,3,3,2,2,2,2,3,3,3,T,T,T],
            [T,T,T,T,3,2,2,T,T,2,3,3,T,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T],
            [T,T,T,3,3,3,T,T,T,T,3,3,3,T,T,T]
        ]
    ],
    left: [
        // Frame 1
        [
            [T,T,T,T,T,T,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,T,3,2,2,1,1,1,2,2,3,T,T,T],
            [T,T,T,T,3,2,3,1,1,1,1,2,3,T,T,T],
            [T,T,T,T,3,2,1,1,1,1,1,2,3,T,T,T],
            [T,T,T,T,3,2,2,3,3,1,2,2,3,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,T,T,T,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,3,2,2,3,3,3,3,3,2,3,T,T,T],
            [T,T,3,2,2,2,2,2,2,2,3,2,3,T,T,T],
            [T,T,T,3,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,3,3,3,T,T,T,T,T,T,T,T,T],
            [T,T,T,T,3,3,T,T,T,T,T,T,T,T,T,T]
        ],
        // Frame 2
        [
            [T,T,T,T,T,T,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,T,3,2,2,1,1,1,2,2,3,T,T,T],
            [T,T,T,T,3,2,3,1,1,1,1,2,3,T,T,T],
            [T,T,T,T,3,2,1,1,1,1,1,2,3,T,T,T],
            [T,T,T,T,3,2,2,3,3,1,2,2,3,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,T,T,T,3,3,3,3,3,T,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,3,2,2,3,3,3,3,3,2,3,T,T,T],
            [T,T,T,3,2,2,2,2,2,2,3,2,3,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,T,T,T,T,3,3,3,T,T,T,T,T],
            [T,T,T,T,T,T,T,T,3,3,T,T,T,T,T,T]
        ]
    ],
    right: [
        // Frame 1
        [
            [T,T,T,T,T,3,3,3,3,3,T,T,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,3,2,2,1,1,1,2,2,3,T,T,T,T],
            [T,T,T,3,2,1,1,1,1,3,2,3,T,T,T,T],
            [T,T,T,3,2,1,1,1,1,1,2,3,T,T,T,T],
            [T,T,T,3,2,2,1,3,3,2,2,3,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,T,3,3,3,3,3,T,T,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,3,2,3,3,3,3,3,2,2,3,T,T,T],
            [T,T,T,3,2,3,2,2,2,2,2,2,3,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,T,T,T,T,T,3,3,3,T,T,T,T,T],
            [T,T,T,T,T,T,T,T,T,3,3,T,T,T,T,T]
        ],
        // Frame 2
        [
            [T,T,T,T,T,3,3,3,3,3,T,T,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,3,2,2,1,1,1,2,2,3,T,T,T,T],
            [T,T,T,3,2,1,1,1,1,3,2,3,T,T,T,T],
            [T,T,T,3,2,1,1,1,1,1,2,3,T,T,T,T],
            [T,T,T,3,2,2,1,3,3,2,2,3,T,T,T,T],
            [T,T,T,T,3,2,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,T,3,3,3,3,3,T,T,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,3,3,2,2,2,2,2,3,T,T,T,T],
            [T,T,T,3,2,3,3,3,3,3,2,2,3,T,T,T],
            [T,T,T,3,2,3,2,2,2,2,2,2,2,3,T,T],
            [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
            [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
            [T,T,T,T,T,T,T,T,3,3,3,T,T,T,T,T],
            [T,T,T,T,T,T,T,T,T,T,3,3,T,T,T,T]
        ]
    ]
};

// Sprites des PNJ (AVEC TRANSPARENCE)
const NPC_SPRITES = {
    // Vieil homme (immobile)
    oldMan: [
        [T,T,T,T,T,2,2,2,2,2,2,T,T,T,T,T],
        [T,T,T,T,2,1,1,1,1,1,1,2,T,T,T,T],
        [T,T,T,2,1,1,2,1,1,2,1,1,2,T,T,T],
        [T,T,T,2,1,3,3,1,1,3,3,1,2,T,T,T],
        [T,T,T,2,1,1,1,1,1,1,1,1,2,T,T,T],
        [T,T,T,2,1,1,1,3,3,1,1,1,2,T,T,T],
        [T,T,T,T,2,1,1,1,1,1,1,2,T,T,T,T],
        [T,T,T,T,T,2,2,2,2,2,2,T,T,T,T,T],
        [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
        [T,T,T,3,2,3,3,3,3,3,3,2,3,T,T,T],
        [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
        [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
        [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T]
    ],
    // Marchand
    merchant: [
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,3,2,1,1,1,1,1,1,2,3,T,T,T],
        [T,T,T,3,2,1,3,1,1,3,1,2,3,T,T,T],
        [T,T,T,3,2,1,1,1,1,1,1,2,3,T,T,T],
        [T,T,T,3,2,2,3,3,3,3,2,2,3,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,2,2,2,2,2,2,2,2,T,T,T,T],
        [T,T,T,2,1,2,2,2,2,2,2,1,2,T,T,T],
        [T,T,2,1,1,2,1,1,1,1,2,1,1,2,T,T],
        [T,T,2,1,1,2,1,1,1,1,2,1,1,2,T,T],
        [T,T,T,2,2,2,1,1,1,1,2,2,2,T,T,T],
        [T,T,T,T,T,2,1,1,1,1,2,T,T,T,T,T],
        [T,T,T,T,2,2,2,T,T,2,2,2,T,T,T,T],
        [T,T,T,T,2,2,2,T,T,2,2,2,T,T,T,T]
    ],
    // Chat (mobile)
    cat: [
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,3,3,T,T,T,T,T,T,T,3,3,T,T,T],
        [T,T,3,2,3,T,T,T,T,T,3,2,3,T,T,T],
        [T,T,3,2,2,3,3,3,3,3,2,2,3,T,T,T],
        [T,T,T,3,2,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,3,2,3,2,2,2,3,2,3,T,T,T,T],
        [T,T,T,3,2,2,2,3,2,2,2,3,T,T,T,T],
        [T,T,T,3,2,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,3,2,2,2,2,2,2,2,2,2,3,T,T,T],
        [T,3,2,2,3,3,3,3,3,3,3,2,2,3,T,T],
        [T,3,2,2,3,T,T,T,T,T,3,2,2,3,T,T],
        [T,T,3,3,T,T,T,T,T,T,T,3,3,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T]
    ],
    // Garde (immobile)
    guard: [
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,3,2,2,2,2,2,2,2,2,3,T,T,T],
        [T,T,T,3,2,1,3,1,1,3,1,2,3,T,T,T],
        [T,T,T,3,2,1,1,1,1,1,1,2,3,T,T,T],
        [T,T,T,3,2,2,1,3,3,1,2,2,3,T,T,T],
        [T,T,T,T,3,2,2,2,2,2,2,3,T,T,T,T],
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
        [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
        [T,T,3,3,3,3,3,3,3,3,3,3,3,3,T,T],
        [T,T,3,3,3,3,3,3,3,3,3,3,3,3,T,T],
        [T,T,T,3,3,3,3,3,3,3,3,3,3,T,T,T],
        [T,T,T,T,T,3,3,3,3,3,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T]
            ],
            // Oiseau (mobile)
            
    bird: [
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,3,3,3,T,T,T,T,T,T,T],
        [T,T,T,T,T,3,2,2,2,3,T,T,T,T,T,T],
        [T,3,3,T,3,2,1,3,1,2,3,T,T,3,3,T],
        [3,2,2,3,3,2,2,2,2,2,3,3,3,2,2,3],
        [T,3,2,2,3,3,2,2,2,3,3,2,2,2,3,T],
        [T,T,3,2,2,3,3,3,3,3,2,2,2,3,T,T],
        [T,T,T,3,2,2,2,2,2,2,2,2,3,T,T,T],
        [T,T,T,T,3,3,3,3,3,3,3,3,T,T,T,T],
        [T,T,T,T,T,1,T,T,T,T,1,T,T,T,T,T],
        [T,T,T,T,T,1,T,T,T,T,1,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T]
    ],

    slime: [
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T],
        [T,T,T,T,T,2,2,2,2,2,2,T,T,T,T,T],
        [T,T,T,T,2,2,2,2,2,2,2,2,T,T,T,T],
        [T,T,T,2,2,2,2,2,2,2,2,2,2,T,T,T],
        [T,T,2,2,1,3,2,2,2,2,3,1,2,2,T,T],
        [T,T,2,2,3,3,2,2,2,2,3,3,2,2,T,T],
        [T,2,2,2,2,2,2,3,3,2,2,2,2,2,2,T],
        [T,2,2,2,2,2,2,2,2,2,2,2,2,2,2,T],
        [T,2,2,2,2,2,2,2,2,2,2,2,2,2,2,T],
        [T,2,2,2,2,2,2,2,2,2,2,2,2,2,2,T],
        [T,T,2,2,2,2,2,2,2,2,2,2,2,2,T,T],
        [T,T,T,2,2,2,2,2,2,2,2,2,2,T,T,T],
        [T,T,T,T,2,2,2,2,2,2,2,2,T,T,T,T],
        [T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T]
    ],

    goblin: [
        [T,T,T,T,T,2,2,2,2,2,2,T,T,T,T,T],
        [T,T,T,T,2,2,2,2,2,2,2,2,T,T,T,T],
        [T,T,T,2,2,2,2,2,2,2,2,2,2,T,T,T],
        [T,T,2,2,2,3,1,2,2,1,3,2,2,2,T,T],
        [T,T,2,2,2,1,3,2,2,3,1,2,2,2,T,T],
        [T,T,2,2,2,2,2,3,3,2,2,2,2,2,T,T],
        [T,T,T,2,2,2,3,3,3,3,2,2,2,T,T,T],
        [T,T,T,T,2,2,2,2,2,2,2,2,T,T,T,T],
        [T,T,T,T,3,3,2,2,2,2,3,3,T,T,T,T],
        [T,T,T,3,2,3,2,2,2,2,3,2,3,T,T,T],
        [T,T,3,2,2,3,3,3,3,3,3,2,2,3,T,T],
        [T,T,3,2,2,3,2,2,2,2,3,2,2,3,T,T],
        [T,T,T,3,3,3,2,2,2,2,3,3,3,T,T,T],
        [T,T,T,T,T,3,2,2,2,2,3,T,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T],
        [T,T,T,T,3,3,3,T,T,3,3,3,T,T,T,T]
    ]
        };

